<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Exercise - An automated autopsy - NU Solar Software Team Training - Fall 2023</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = null;
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../../index.html">Introduction</a></li><li class="chapter-item expanded "><a href="../../purpose.html"><strong aria-hidden="true">1.</strong> Our purpose</a></li><li class="chapter-item expanded affix "><li class="part-title">A Telemetry Pipeline</li><li class="chapter-item expanded "><a href="../../pipeline/step-0/index.html"><strong aria-hidden="true">2.</strong> Current in a wire</a></li><li class="chapter-item expanded "><a href="../../pipeline/step-1/index.html"><strong aria-hidden="true">3.</strong> A stream of bytes</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../pipeline/step-1/representing-data.html"><strong aria-hidden="true">3.1.</strong> Representing data</a></li><li class="chapter-item expanded "><a href="../../pipeline/step-1/can-frames.html"><strong aria-hidden="true">3.2.</strong> CAN frames</a></li><li class="chapter-item expanded "><a href="../../pipeline/step-1/exercise.html"><strong aria-hidden="true">3.3.</strong> Exercise - Thinking like a computer</a></li></ol></li><li class="chapter-item expanded "><a href="../../pipeline/step-2/index.html"><strong aria-hidden="true">4.</strong> An object in memory</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../pipeline/step-2/python/index.html"><strong aria-hidden="true">4.1.</strong> The Python programming language</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../pipeline/step-2/python/setting-up.html"><strong aria-hidden="true">4.1.1.</strong> Setting up</a></li><li class="chapter-item expanded "><a href="../../pipeline/step-2/python/basics.html"><strong aria-hidden="true">4.1.2.</strong> Basics</a></li></ol></li><li class="chapter-item expanded "><a href="../../pipeline/step-2/exercise.html" class="active"><strong aria-hidden="true">4.2.</strong> Exercise - An automated autopsy</a></li></ol></li><li class="chapter-item expanded "><a href="../../pipeline/step-3/index.html"><strong aria-hidden="true">5.</strong> A row in a table</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../pipeline/step-3/sql/index.html"><strong aria-hidden="true">5.1.</strong> SQL</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../pipeline/step-3/sql/setting-up.html"><strong aria-hidden="true">5.1.1.</strong> Setting up</a></li><li class="chapter-item expanded "><a href="../../pipeline/step-3/sql/basics.html"><strong aria-hidden="true">5.1.2.</strong> Basics</a></li></ol></li><li class="chapter-item expanded "><a href="../../pipeline/step-3/exercise.html"><strong aria-hidden="true">5.2.</strong> Exercise - Persistence is key</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">6.</strong> A packet in a network</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">6.1.</strong> A stream of bytes, revisited</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">6.2.</strong> Exercise - Parsing from a distance</div></li></ol></li><li class="chapter-item expanded "><li class="part-title">Tools</li><li class="chapter-item expanded "><a href="../../tools/command-line.html"><strong aria-hidden="true">7.</strong> The command line</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">8.</strong> Git and GitHub</div></li><li class="chapter-item expanded affix "><li class="part-title">The Telemetry System</li><li class="chapter-item expanded "><div><strong aria-hidden="true">9.</strong> Data flow</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">10.</strong> Data visualization</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">10.1.</strong> Onboard Display</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">10.2.</strong> Base station dashboard</div></li></ol></li><li class="chapter-item expanded "><a href="../../system/goals.html"><strong aria-hidden="true">11.</strong> Goals</a></li><li class="chapter-item expanded affix "><li class="part-title">Hardware Reference</li><li class="chapter-item expanded "><div><strong aria-hidden="true">12.</strong> CANUSB COM FD</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">13.</strong> Raspberry Pi 4</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">14.</strong> PiCAN 2</div></li><li class="chapter-item expanded "><a href="../../hardware/wavesculptor22.html"><strong aria-hidden="true">15.</strong> Tritium WaveSculptor 22 Motor Controller</a></li><li class="chapter-item expanded "><a href="../../hardware/driver-controls.html"><strong aria-hidden="true">16.</strong> Prohelion EV Driver Controls</a></li><li class="chapter-item expanded "><a href="../../hardware/mppt.html"><strong aria-hidden="true">17.</strong> Elmar Solar MPPT</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">18.</strong> Digi XBeeÂ® SX 1-Watt 900 MHz RF</div></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">NU Solar Software Team Training - Fall 2023</h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="exercise---an-automated-autopsy"><a class="header" href="#exercise---an-automated-autopsy">Exercise - An automated autopsy</a></h1>
<p>This exercise is broken into two parts. In the first section, you will craft a
Python parser to interpret real CAN frames sent by an isolated MPPT under
idle operation. Values sent by this MPPT will be boring and predictable. In part
two, you'll adapt your parser to handle CAN data from multiple connected devices.
The data in part two will be generated to contain a mysteryâat some point in this
fabricated scenario, a failure will occur in the car. Your job is to analyze the
CAN traffic to determine when and where the failure first appeared, and what might
have caused it.</p>
<h2 id="part-1---isolated-mppt"><a class="header" href="#part-1---isolated-mppt">Part 1 - Isolated MPPT</a></h2>
<p><a href="../../misc/mppt_data.txt">This data file</a> contains CAN frames sent by an MPPT
(base address 0x600) on it's own CAN network. Frames in this file appear in a
<code>[Frame ID] [Data]</code> text format, separated by newlines. Frame IDs and data are
given in hex, although the leading &quot;0x&quot; is omitted.</p>
<p>Your job is to use the MPPT datasheet to construct a Python program that processes
this file into something human-readable.</p>
<p>Remember that variables in CAN frames are stored in little-endian byte-order.</p>
<hr />
<details>
<summary><b>Hint</b></summary>
<p>You may find the
<a href="https://docs.python.org/3/library/binascii.html#binascii.unhexlify">binascii.unhexlify</a>
and <a href="https://docs.python.org/3/library/struct.html#struct.unpack">struct.unpack</a>
functions helpful in converting from a hex string to an integer or float.</p>
<p>You can also use <code>int(some_hex_string, 16)</code> to parse a hex string to an integer. This
can also be done with <code>unpack</code> and <code>unhexlify</code>, but <code>unhexlify</code> requires an even number
of hex digits, so it can be a bit nicer to just use <code>int</code> directly for, say, the frame
id, which is 3 hex digits.</p>
</details>
<hr />
<details>
<summary><b>Example</b></summary>
<p>The first line in the data file is <code>604 6666DA420000E040</code>. We can recognize this as a
frame sent by the MPPT at base address 0x600 with an id offset of 0x4.</p>
<p>The relevant section of the MPPT datasheet tells us that this is the &quot;Limits&quot; message,
which contains the following variables.</p>
<div class="table-wrapper"><table><thead><tr><th>Variable</th><th>Byte</th><th>Type</th><th>Unit</th></tr></thead><tbody>
<tr><td>Max. Output Voltage</td><td>0-3</td><td>FLOAT</td><td>Volt</td></tr>
<tr><td>Max. Input Current</td><td>4-7</td><td>FLOAT</td><td>Ampere</td></tr>
</tbody></table>
</div>
<p>Here's how we can parse this frame in Python.</p>
<p>Let's start by storing the first frame in a variable and then splitting it
into the frame id and the data:</p>
<pre><code class="language-python">raw_frame = &quot;604 6666DA420000E040&quot;
frame_id, data = raw_frame.split(&quot; &quot;)
</code></pre>
<p>The <code>frame_id, data = ...</code> syntax we used above is called &quot;unpacking&quot; or
&quot;destructuring&quot;, and it is a clean way of breaking down a list (or any iterable)
into multiple variables. In this case, <code>raw_frame.split(&quot; &quot;)</code> returned a list
of 2 strings, the first of which we assigned to <code>frame_id</code>, and the second to
<code>data</code>. It would have been equivalent to write:</p>
<pre><code class="language-python">split = raw_frame.split(&quot; &quot;)
frame_id = split[0]
data = split[1]
</code></pre>
<p>At this point, both the <code>frame_id</code> and <code>data</code> variable are strings (text).
Because in general we need to examine the offset of the frame id from the
base address to determine the message type, we will need to convert <code>frame_id</code>
to an integer. Similarly, we will need to end up converting portions of
data into the types specified by the MPPT datasheet.</p>
<p>To convert <code>frame_id</code> into an integer, we can use
<a href="https://docs.python.org/3/library/functions.html#int">Python's builtin <code>int</code></a>
function with two arguments to parse a string into an integer.</p>
<pre><code class="language-python">frame_id = int(frame_id, 16)
</code></pre>
<p>We can then determine the offset from the base address programmatically:</p>
<pre><code class="language-python">offset = frame_id - 0x600
</code></pre>
<p>Notice that Python allows you to write integers directly in hex using the <code>0x</code> prefix.</p>
<p>Of course, in this case we already know that the offset is 4. But, in general, you'll
need to determine the offset and then examine the data accordingly. Let's say we're
choosing to do this in one big <code>if ... elif ... elif ... else</code> block.</p>
<pre><code class="language-python">if offset == 0:
    ... # handle offset 0
elif offset == 1
    ... # handle offset 1

... # handle more offsets

elif offset == 4
    ... # handle offset 4

... # handle more offsets
</code></pre>
<p>For the frame we're examining in this example, we know that we're going to end up inside
the branch for <code>offset == 4</code>. The MPPT specs tell us that a broadcast message with offset
4 contains two 32-bit floats in the data field. We can break the data into halves using
Python's slicing syntax:</p>
<pre><code class="language-python">first_half = data[:8]
second_half = data[8:]
</code></pre>
<p>And then we can use <code>unhexlify</code> to convert each half from a string to the represented bytes:</p>
<pre><code class="language-python">from binascii import unhexlify

first_half = unhexlify(first_half)
second_half = unhexlify(second_half)
</code></pre>
<p>Note that we could equivalently have chosen to <code>unhexlify</code> the whole message first, and then
slice it into halves.</p>
<p>Finally, we can use <code>unpack</code> to decode the bytes into little-endian floats (the <code>&quot;&lt;f&quot;</code>
given to <code>unpack</code> is a format specifier meaning little-endian 32-bit float; you can find
more info in the docs for <code>unpack</code>).</p>
<pre><code class="language-python">from struct import unpack

max_output_voltage = unpack(&quot;&lt;f&quot;, first_half)[0]
max_input_current = unpack(&quot;&lt;f&quot;, second_half)[0]
</code></pre>
<p>At this point, we've decoded the CAN frame! You can now print the decoded information to
the screen, append it to a list, store it in a dictionary, or use whatever format you
think works best.</p>
</details>
<hr />
<details>
<summary><b>Solution</b></summary>
<p>There are many possible ways to write the code to solve this exercise, so
you're not expected to have written code that looks the same as this.
This is only one of the possible solutions and is here as a reference.</p>
<pre><code class="language-python"># We're going to use the `unhexlify` function to convert hex strings into the
# actual bytes they represent.
from binascii import unhexlify

# We'll also use the `unpack` function to decode `float`s and `int`s from
# raw bytes.
from struct import unpack

def decode_mppt_data(offset, data):
    if offset == 0:
        # Input measurements
        return {
            &quot;Input Voltage (V)&quot;: unpack(&quot;&lt;f&quot;, data[:4])[0],
            &quot;Input Current (A)&quot;: unpack(&quot;&lt;f&quot;, data[4:])[0],
        }
    elif offset == 1:
        # Output measurements
        return {
            &quot;Output Voltage (V)&quot;: unpack(&quot;&lt;f&quot;, data[:4])[0],
            &quot;Output Current (A)&quot;: unpack(&quot;&lt;f&quot;, data[4:])[0],
        }
    elif offset == 2:
        # Temperature
        return {
            &quot;Mosfet Temperature (deg. Celsius)&quot;    : unpack(&quot;&lt;f&quot;, data[:4])[0],
            &quot;Controller Temperature (deg. Celsius)&quot;: unpack(&quot;&lt;f&quot;, data[4:])[0],
        }
    elif offset == 3:
        # Auxiliary power supply
        return {
            &quot;12V (V)&quot;: unpack(&quot;&lt;f&quot;, data[:4])[0],
            &quot;3V (V)&quot; : unpack(&quot;&lt;f&quot;, data[4:])[0],
        }
    elif offset == 4:
        # Limits
        return {
            &quot;Max. Output Voltage (V)&quot;: unpack(&quot;&lt;f&quot;, data[:4])[0],
            &quot;Max. Input Current (C)&quot; : unpack(&quot;&lt;f&quot;, data[4:])[0],
        }
    elif offset == 5:
        # Status
        return {
            &quot;CAN RX error counter&quot;   : unpack(&quot;&lt;B&quot;, data[:1])[0],
            &quot;CAN TX error counter&quot;   : unpack(&quot;&lt;B&quot;, data[1:2])[0],
            &quot;CAN TX overflow counter&quot;: unpack(&quot;&lt;B&quot;, data[2:3])[0],
            &quot;Error flags&quot;            : unpack(&quot;&lt;B&quot;, data[3:4])[0],
            &quot;Limit flags&quot;            : unpack(&quot;&lt;B&quot;, data[4:5])[0],
            &quot;Mode&quot;                   : unpack(&quot;&lt;B&quot;, data[5:6])[0],
            &quot;Test counter&quot;           : unpack(&quot;&lt;B&quot;, data[7:])[0],
        }
    elif offset == 6:
        # Power connector
        return {
            &quot;Output Voltage (Battery side of fuse) (V)&quot;: unpack(&quot;&lt;f&quot;, data[:4])[0],
            &quot;Power connector Temperature (deg. Celsius)&quot; : unpack(&quot;&lt;f&quot;, data[4:])[0],
        }
    else:
        # Unknown message, throw an error to the caller.
        raise Exception(f&quot;No message matches offset 0x{offset:x}&quot;)

def decode_data(base_address, offset, data):
    if base_address == 0x600:
        # If the base address belongs to a known MPPT, decode the data using
        # a MPPT-specific helper function, and return the decoded message.
        return { &quot;sender&quot;: base_address, &quot;message&quot;: decode_mppt_data(offset, data) } 
    else:
        # Otherwise, the message doesn't match any known device. Throw an error
        # to the caller.
        raise Exception(f&quot;No device matches base address 0x{base_address:x}&quot;)

with open(&quot;mppt_data.txt&quot;, &quot;r&quot;) as f:
    for line in f:
        # Take the line, remove any leading/trailing whitespace,
        # and then split across the space dividing the frame id from the data.
        left, right = line.strip().split(&quot; &quot;)

        # Convert the frame id hex string into an actual number.
        frame_id = int(left, 16)

        # Convert the data hex string into bytes.
        data = unhexlify(right)

        # Decompose the frame id into a base address and offset.
        base_address, offset = divmod(frame_id, 16)
        base_address *= 16

        # Decode the message and print it.
        print(decode_data(base_address, offset, data))
</code></pre>
<p>The result of running this program on the MPPT data provided above can
be found in <a href="../../misc/mppt_data_decoded.txt">this output file</a>.</p>
</details>
<hr />
<h2 id="part-2---chaos-on-the-can-network"><a class="header" href="#part-2---chaos-on-the-can-network">Part 2 - Chaos on the CAN network</a></h2>
<p>In this exercise, you'll will be given a dump of CAN traffic from the following
made-up scenario.</p>
<blockquote>
<p>Because the CAN data for this scenario has been fabricated, you shouldn't expect
to see super-realistic and -consistent data reported across all the devices on
the network. Rather, the tampered data has been made in a way to (hopefully) make
localizing a fault easier.</p>
</blockquote>
<p>While working on an electrical line in SC7s, members of the Electrical team heard a pop
from within the car. A few seconds later, the top-shell was lifted, and one of the devices
attached to the CAN line was found damaged and unresponsive. The car was then immediately
powered off.</p>
<p>This incident occurred during winter, while the car was idle (not driving) and being worked-on
in North Garage. The Electrical team reported the following CAN network configuration:</p>
<ul>
<li>MPPT at base address 0x600</li>
<li>MPPT at base address 0x610</li>
<li>MPPT at base address 0x620</li>
<li>Motor controller at base address 0x400</li>
<li>Driver controls at base address 0x500</li>
<li>Battery management system</li>
</ul>
<p>They were also able to provide
<a href="../../misc/can_traffic.txt">this log of CAN traffic in the minutes leading up to the incident</a>.</p>
<p><strong>By analyzing this CAN traffic, can you figure out which device was damaged, what type of damage
was sustained, and what may have caused the failure?</strong></p>
<h2 id="advice"><a class="header" href="#advice">Advice</a></h2>
<p>Many of the messages in the given data file come from the battery management system (BMS), which
works a little differently than the other devices you are familiar with. CAN frames broadcast
from the BMS are programmable and do not necessarily follow the base address + offset pattern
used by the other devices. For this exercise, <strong>the BMS is not relevant to electrical failure</strong>,
which means you should ignore any messages from the BMS (i.e. the ones that are not from
the MPPTs, motor controller, or driver controls).</p>
<p>You may also not need to decode every frame from the other devices. It's possible to complete
this exercise by identifying oddities in the raw frames, and limiting your focus only to those
oddities.</p>
<hr />
<details>
<summary><b>Hint #1</b></summary>
<p>We know that the &quot;pop&quot; was heard just a few seconds before the car was powered off (at which point
the CAN traffic ends). So it's reasonable to expect the failure to appear very near to the end
of the traffic log file.</p>
<p>You also should try looking for CAN messages that stop being sent <em>before</em> the rest of the traffic
ends, the idea being to identify the damaged device by seeing if it goes silent.</p>
<p>You might also try looking for messages that only start appearing near the end of the log file.
You may observe a &quot;reset&quot; message that one device sends when another stops responding.</p>
<p>Note that you can make these observations by only looking at the frame IDs and not actually
decoding any data. So this might be a good starting point.</p>
</details>
<hr />
<details>
<summary><b>Hint #2</b></summary>
<p>The previous hint should let you identify which device has failed: it's the motor controller
at base address 0x400. The last message sent by the motor controller occurs at line 42776,
over 300 lines before the file. For comparison, all the other devices on the network have
messages appearing at most 35 lines from the end of the file. You could also have identified
the issue with the motor controller by observing the first appearance of the message with
ID 0x503 at line 42888. This message is a &quot;reset&quot; message sent from the driver controls to
the motor controller, indicating a problem with the motor controller.</p>
<p>Now that you know which device has been damaged, it's time to figure out what happened.
To do this, you need to decode some messages from the motor controller. Many of the messages
have all zeros in their dataâthose probably aren't worth decoding. Also, remember that the
car isn't driving in this scenario, so messages indicating motor and vehicle velocities likely
aren't relevant either. For the remaining messages, try decoding, say, the last 10 instances of
each. Are there any values that are changing rapidly?</p>
</details>
<hr />

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../pipeline/step-2/python/basics.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../../pipeline/step-3/index.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../pipeline/step-2/python/basics.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../../pipeline/step-3/index.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
